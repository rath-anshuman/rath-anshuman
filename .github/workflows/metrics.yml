name: Generate Metrics

on:
  schedule:
    - cron: "30 */12 * * *"   # every 12 hours
  workflow_dispatch:

permissions:
  contents: write   # <-- critical for pushes

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Generate metrics
        uses: lowlighter/metrics@latest
        with:
          # --- tokens ---
          token: ${{ secrets.METRICS_TOKEN }}         # PAT for API calls (read)
          committer_token: ${{ secrets.METRICS_TOKEN }} # PAT for committing (write)

          # --- commit target ---
          committer_branch: main
          committer_message: "chore(metrics): update metrics.svg"
          filename: metrics.svg

          # --- basics ---
          user: rath-anshuman
          template: classic
          base: header, activity, community, repositories
          config_timezone: Asia/Kolkata

          # --- plugins (example) ---
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year
          plugin_achievements: yes
          plugin_achievements_threshold: C
          plugin_achievements_secrets: yes
          plugin_achievements_limit: 6
          plugin_notable: yes
          plugin_notable_repositories: yes
